# General Assembly districts {findings-ga}

```{r}
#| label: setup

library(tidyverse)
library(kableExtra)
library(hdatools)
library(sf)
library(geojsonsf)
library(ggtext)
library(scales)
library(leaflet)
library(htmlwidgets)
library(classInt)
library(htmltools)

hd <- read_rds("data/rds/faith_house.rds")

va_lng <- -79.4587
va_lat <- 38.00344

```

```{css}

.quarto-figure-center>figure>p, .quarto-figure-center>figure>div {
    text-align: left;
}

```

The introduction of the Faith in Housing bill into the Virginia General Assembly presents an opportunity to also explore faith-based parcel ownership at based on house and senate districts. This provides state legislatures with a unique perspective on aspects of faith-based parcel ownership within their districts.

::: {.callout-note}
### State legislative districts in Virginia
There are 100 House Districts and 40 Senate Districts in the Virginia General Assembly. District lines were [recently redrawn](https://www.vpap.org/redistricting/) in 2021 by the Supreme Court of Virginia after Virginia's Redistricting Commission never came to an agreement.
:::

## House Districts

Based on House Districts, the majority of faith-based parcel ownership is in southern and southwest Virginia. House Districts 45 and 46 contain the largest number of parcels owned by faith organizations, 2,080 and 1,199, respectively. They are followed by House District 49 (928 parcels).

::: {#fig-parcels-hd}

```{r}

# # Function to create color palette based on Jenks breaks
# create_jenks_palette <- function(data, n_classes = 5) {
#   # Remove any NA values
#   data <- data[!is.na(data)]
# 
#   # Calculate Jenks breaks
#   breaks <- classIntervals(data, n = n_classes, style = "jenks")
# 
#   # Create a color palette
#   pal <- colorBin(
#     palette = "YlOrRd",
#     domain = data,
#     bins = breaks$brks,
#     pretty = FALSE
#   )
# 
#   return(pal)
# }
# 
# # Create the Jenks breaks color palette
# jenks_pal <- create_jenks_palette(hd$faith_house_count)
# 
# # Create the leaflet map
# map_jenks <- leaflet(hd, options = leafletOptions(zoomControl = FALSE,  zoomSnap = 0.25)) |>
#   setView(va_lng, va_lat, zoom = 6.75) |>
#   addProviderTiles("CartoDB.Positron") |>
#   addPolygons(
#     fillColor = ~jenks_pal(faith_house_count),
#     fillOpacity = 0.7,
#     color = "grey",
#     weight = 1,
#     popup = ~paste("House District:", NAMELSAD, "<br>Parcels:", label_count)
#   ) |>
#   addLegend(
#     pal = jenks_pal,
#     values = hd$faith_house_count,
#     title = "Total Parcels",
#     position = "topleft"
#   ) |>
#   onRender(
#     "function(el, x) {
#         L.control.zoom({position:'topright'}).addTo(this);
#       }"
#   )
# 
# map_jenks

#saveWidget(map_jenks, "data/geo/hd_count.html")

# Display the map

knitr::include_url("data/geo/hd_count.html")

```

Total parcels by House District

:::

When focused on total acreage of faith-owned parcels, House District 33 and and House District 71 exceed their peers. House District 33's large amount of faith-owned land is due greatly to the presence of Shrine Mont, a large retreat and conference center located in Orkney Springs, Virginia and owned by the Episcopal Diocese.

::: {#fig-acres-hd}

```{r}

# hd <- read_rds("data/rds/faith_house.rds")
# 
# # Function to create color palette based on Jenks breaks
# create_jenks_palette <- function(data, n_classes = 5) {
#   # Remove any NA values
#   data <- data[!is.na(data)]
# 
#   # Calculate Jenks breaks
#   breaks <- classIntervals(data, n = n_classes, style = "jenks")
# 
#   # Create a color palette
#   pal <- colorBin(
#     palette = "YlGn",
#     domain = data,
#     bins = breaks$brks,
#     pretty = FALSE
#   )
# 
#   return(pal)
# }
# 
# # Create the Jenks breaks color palette
# jenks_pal <- create_jenks_palette(hd$faith_house_total_acres)
# 
# # Create the leaflet map
# map_jenks <- leaflet(hd, options = leafletOptions(zoomControl = FALSE,  zoomSnap = 0.25)) |>
#   setView(va_lng, va_lat, zoom = 6.75) |>
#   addProviderTiles("CartoDB.Positron") |> 
#   addPolygons(
#     fillColor = ~jenks_pal(faith_house_total_acres),
#     fillOpacity = 0.7,
#     color = "grey",
#     weight = 1,
#     popup = ~paste("House District:", NAMELSAD, "<br>Value:", label_acres)
#   ) |> 
#   addLegend(
#     pal = jenks_pal,
#     values = hd$faith_house_total_acres,
#     title = "Total Acres",
#     position = "topleft"
#   ) |>
#   onRender(
#     "function(el, x) {
#         L.control.zoom({position:'topright'}).addTo(this);
#       }"
#   )
# 
# saveWidget(map_jenks, "data/geo/hd_acres.html")

knitr::include_url("data/geo/hd_acres.html")

```

Total acres by House District

:::

The median parcel size can better help us understand areas where there is adequate, contiguous land that could be developed. Based on House Districts, large parcels are located in House District 88 (9.54 acres), House District 28 (9.26 acres), and House District 26 (7.14). The presence of smaller median parcel size in a district does not necessarily mean that properties are too small to develop, but could be an indication of multiple adjacent parcels under the same ownership. However, the results provide us with a preliminary assessment of typical parcel size in each district.

::: {#fig-size-hd}

```{r}

# hd <- read_rds("data/rds/faith_house.rds")
# 
# # Function to create color palette based on Jenks breaks
# create_jenks_palette <- function(data, n_classes = 5) {
#   # Remove any NA values
#   data <- data[!is.na(data)]
# 
#   # Calculate Jenks breaks
#   breaks <- classIntervals(data, n = n_classes, style = "jenks")
# 
#   # Create a color palette
#   pal <- colorBin(
#     palette = "YlGnBu",
#     domain = data,
#     bins = breaks$brks,
#     pretty = FALSE
#   )
# 
#   return(pal)
# }
# 
# # Create the Jenks breaks color palette
# jenks_pal <- create_jenks_palette(hd$med_parcel_size)
# 
# # Create the leaflet map
# map_jenks <- leaflet(hd, options = leafletOptions(zoomControl = FALSE,  zoomSnap = 0.25)) |>
#   setView(va_lng, va_lat, zoom = 6.75) |>
#   addProviderTiles("CartoDB.Positron") |> 
#   addPolygons(
#     fillColor = ~jenks_pal(med_parcel_size),
#     fillOpacity = 0.7,
#     color = "grey",
#     weight = 1,
#     popup = ~paste("House District:", NAMELSAD, "<br>Value:", label_size)
#   ) |> 
#   addLegend(
#     pal = jenks_pal,
#     values = hd$med_parcel_size,
#     title = "Median Parcel Size",
#     position = "topleft"
#   ) |> 
#   onRender(
#     "function(el, x) {
#         L.control.zoom({position:'topright'}).addTo(this);
#       }"
#   )
# 
# saveWidget(map_jenks, "data/geo/hd_size.html")

knitr::include_url("data/geo/hd_size.html")

```

Median parcel size by House District

:::

## Senate Districts

Senate Districts undoubtedly show similar patterns as House Districts. Senate Districts 40 (2,545) and 15 (1,727), in southwest and southern Virginia, contain the most faith-owned parcels. They are followed by other Senate Districts in the south and southwest part of the state.

```{r}
#| label: fig-parcels-sd
#| fig-cap: "Total parcels by Senate District"

# sd <- read_rds("data/rds/faith_senate.rds")
# 
# # Function to create color palette based on Jenks breaks
# create_jenks_palette <- function(data, n_classes = 5) {
#   # Remove any NA values
#   data <- data[!is.na(data)]
#   
#   # Calculate Jenks breaks
#   breaks <- classIntervals(data, n = n_classes, style = "jenks")
#   
#   # Create a color palette
#   pal <- colorBin(
#     palette = "YlOrRd",
#     domain = data,
#     bins = breaks$brks,
#     pretty = FALSE
#   )
#   
#   return(pal)
# }
# 
# # Create the Jenks breaks color palette
# jenks_pal <- create_jenks_palette(sd$faith_senate_count)
#   
# 
# # Create the leaflet map
# map_jenks <- leaflet(sd) %>%
#   addProviderTiles("CartoDB.Positron") %>%
#   addPolygons(
#     fillColor = ~jenks_pal(faith_senate_count),
#     fillOpacity = 0.7,
#     color = "grey",
#     weight = 1,
#     popup = ~paste("Senate District:", NAMELSAD, "<br>Parcels:", label_count)
#   ) %>%
#   addLegend(
#     pal = jenks_pal,
#     values = sd$faith_senate_count,
#     title = "Total Parcels",
#     position = "topleft"
#   )
# 
# # Display the map
# saveWidget(map_jenks, "data/geo/sd_count.html")

#knitr::include_url("data/geo/sd_count.html", height = "400px")

```

Senate Districts with the largest total acreage of faith-owned parcels are Senate Districts 26 (12,598.90 acres) and 3 (6,381.74 acres). Once again, Senate District 26 is impacted by the presence of Shrine Mont.

```{r}
#| label: fig-acres-sd
#| fig-cap: "Total acres by Senate District"


# sd <- read_rds("data/rds/faith_senate.rds")
# 
# # Function to create color palette based on Jenks breaks
# create_jenks_palette <- function(data, n_classes = 5) {
#   # Remove any NA values
#   data <- data[!is.na(data)]
#   
#   # Calculate Jenks breaks
#   breaks <- classIntervals(data, n = n_classes, style = "jenks")
#   
#   # Create a color palette
#   pal <- colorBin(
#     palette = "YlGn",
#     domain = data,
#     bins = breaks$brks,
#     pretty = FALSE
#   )
#   
#   return(pal)
# }
# 
# # Create the Jenks breaks color palette
# jenks_pal <- create_jenks_palette(sd$faith_senate_total_acres)
# 
# # Create the leaflet map
# map_jenks <- leaflet(sd) %>%
#   addProviderTiles("CartoDB.Positron") %>%
#   addPolygons(
#     fillColor = ~jenks_pal(faith_senate_total_acres),
#     fillOpacity = 0.7,
#     color = "grey",
#     weight = 1,
#     popup = ~paste("Senate District:", NAMELSAD, "<br>Value:", label_acres)
#   ) %>%
#   addLegend(
#     pal = jenks_pal,
#     values = sd$faith_senate_total_acres,
#     title = "Total Acres",
#     position = "topleft"
#   )
# 
# # Display the map
# saveWidget(map_jenks, "data/geo/sd_acres.html")

#knitr::include_url("data/geo/sd_acres.html", height = "400px")

```

Senate Districts with larger median parcel sizes are around the Richmond region and Hampton Roads region. This is a change from House Districts, where House District 28 was ranked fairly high. The increase in the area of the Senate District likely contributed to the change in median parcel size, with the inclusion of more smaller sized parcels. Senate Districts 12 (3.34 acres), 11 (2.88 acres), and 7 (2.05 acres) rank highest among their peers in terms of typical parcel size.

```{r}
#| label: fig-size-sd
#| fig-cap: "Median parcel size by Senate District"

# sd <- read_rds("data/rds/faith_senate.rds")
# 
# # Function to create color palette based on Jenks breaks
# create_jenks_palette <- function(data, n_classes = 5) {
#   # Remove any NA values
#   data <- data[!is.na(data)]
#   
#   # Calculate Jenks breaks
#   breaks <- classIntervals(data, n = n_classes, style = "jenks")
#   
#   # Create a color palette
#   pal <- colorBin(
#     palette = "YlGnBu",
#     domain = data,
#     bins = breaks$brks,
#     pretty = FALSE
#   )
#   
#   return(pal)
# }
# 
# # Create the Jenks breaks color palette
# jenks_pal <- create_jenks_palette(sd$med_parcel_size)
# 
# # Create the leaflet map
# map_jenks <- leaflet(sd) %>%
#   addProviderTiles("CartoDB.Positron") %>%
#   addPolygons(
#     fillColor = ~jenks_pal(med_parcel_size),
#     fillOpacity = 0.7,
#     color = "grey",
#     weight = 1,
#     popup = ~paste("Senate District:", NAMELSAD, "<br>Value:", label_size)
#   ) %>%
#   addLegend(
#     pal = jenks_pal,
#     values = sd$med_parcel_size,
#     title = "Median Parcel Size",
#     position = "topleft"
#   )
# 
# # Display the map
# saveWidget(map_jenks, "data/geo/sd_size.html")

#knitr::include_url("data/geo/sd_size.html", height = "400px")

```

The data presented above represents a snapshot of faith-owned parcels by Virginia General Assembly Districts. A full exploration of these parcels for site feasibility is outside the scope of this report. However, it is clear that a significant amount of land exists that could represent potential residential development.

